steps:

  # Update our .npmrc file to point to the feed for pylance
  # AZURE_DEVOPS_TOKEN is the base64 encoded access token. See here to create it:
  # https://devdiv.visualstudio.com/DevDiv/_packaging?_a=connect&feed=Pylance
  # https://devdiv.visualstudio.com/_details/security/tokens
  - task: PowerShell@1
    env:
      MAPPED_AZURE_DEVOPS_TOKEN: $(AZURE_DEVOPS_TOKEN)
      MAPPED_AZURE_DEVOPS_USERNAME: $(AZURE_DEVOPS_USERNAME)
    displayName: 'Update .npmrc to find pylance feed'
    inputs:
      scriptName: $(Build.SourcesDirectory)/Build/UpdateNpmrc.ps1

  # Print out npmrc
  - powershell: 'Get-Content ".npmrc"'
    displayName: 'Print .npmrc contents'

  # todo: add pylance version parameter
  # todo: overwrite pylance version in package.json based on pylance version parameter

  # pylance is now installed with the rest of the dependencies in the 'Restore packages' step